# ============================================================================
# kiro2api 环境配置文件示例
# ============================================================================
# 复制此文件为 .env 并根据需要修改配置

# ============================================================================
# Token管理配置（必需）
# ============================================================================
#
# 使用JSON格式配置认证信息，支持多认证方式和多token
# 支持两种配置方式：
#   1. 直接配置JSON字符串（推荐用于简单配置）
#   2. 配置文件路径（推荐用于复杂配置或敏感信息管理）
#
# 基本格式：
# KIRO_AUTH_TOKEN='[认证配置对象数组]'
# 或
# KIRO_AUTH_TOKEN=/path/to/auth_config.json
#
# 每个认证配置对象包含：
# - auth: 认证方式，可选值为 "Social" 或 "IdC"
# - refreshToken: 刷新令牌（必需）
# - clientId: IdC认证的客户端ID（IdC认证时必需）
# - clientSecret: IdC认证的客户端密钥（IdC认证时必需）
# - disabled: 是否禁用此配置（可选，默认false）

# 方式1：直接配置JSON字符串
# 示例1：单个 Social 认证
KIRO_AUTH_TOKEN='[{"auth":"Social","refreshToken":"your_social_refresh_token_here"}]'

# 方式2：配置文件路径（系统会优先检查是否为文件）
# KIRO_AUTH_TOKEN=/path/to/auth_config.json
# KIRO_AUTH_TOKEN=./config/auth.json

# 示例2：单个 IdC 认证
# KIRO_AUTH_TOKEN='[{"auth":"IdC","refreshToken":"your_idc_refresh_token_here","clientId":"your_idc_client_id","clientSecret":"your_idc_client_secret"}]'

# 示例3：多个认证混合（推荐生产环境，实现负载均衡和容错）
# KIRO_AUTH_TOKEN='[
#   {
#     "auth": "Social",
#     "refreshToken": "arn:aws:sso:us-east-1:999999999999:token/refresh/token1"
#   },
#   {
#     "auth": "Social",
#     "refreshToken": "arn:aws:sso:us-east-1:999999999999:token/refresh/token2"
#   },
#   {
#     "auth": "IdC",
#     "refreshToken": "arn:aws:identitycenter::us-east-1:999999999999:account/instance/xxx",
#     "clientId": "https://oidc.us-east-1.amazonaws.com/clients/xxx",
#     "clientSecret": "xxx-secret-key-xxx"
#   }
# ]'

# Token选择策略：
# - 系统使用"顺序选择"策略（sequential）
# - 按配置顺序依次使用token，当前token耗尽后自动切换到下一个
# - 支持多token自动负载均衡和容错

# ============================================================================
# 基础服务配置
# ============================================================================

# 服务端口（默认: 8080）
PORT=8080

# API认证密钥（默认: 123456）
KIRO_CLIENT_TOKEN=123456

# Gin运行模式: debug, release, test（默认: release）
GIN_MODE=release

# ============================================================================
# 日志配置
# ============================================================================

# 日志级别: debug, info, warn, error（默认: info）
LOG_LEVEL=info

# 日志格式: text, json（默认: json）
LOG_FORMAT=json

# 日志文件路径（可选，不设置则只输出到控制台）
# LOG_FILE=/var/log/kiro2api.log

# 控制台输出开关（默认: true）
# LOG_CONSOLE=true

# ============================================================================
# 超时配置
# ============================================================================

# HTTP客户端请求超时配置（分钟）
# REQUEST_TIMEOUT_MINUTES=15              # 复杂请求超时（默认: 15分钟）
# SIMPLE_REQUEST_TIMEOUT_MINUTES=2        # 简单请求超时（默认: 2分钟）

# HTTP服务器超时配置（分钟）
# SERVER_READ_TIMEOUT_MINUTES=16          # 服务器读取超时（默认: 16分钟）
# SERVER_WRITE_TIMEOUT_MINUTES=16         # 服务器写入超时（默认: 16分钟）

# 流式响应配置
# DISABLE_STREAM=false                    # 是否禁用流式响应（默认: false）

# ============================================================================
# 调试配置
# ============================================================================

# 原始数据保存开关（用于调试和问题排查）
# SAVE_RAW_DATA=false                     # 是否保存原始EventStream数据（默认: false）
#                                         # 启用后会将AWS响应的原始数据保存到 test/raw_data_replay/ 目录
#                                         # 仅在需要调试EventStream解析问题时启用

# ============================================================================
# Token获取方式
# ============================================================================
#
# Social tokens:
#   通常位于 ~/.aws/sso/cache/ 目录下的JSON文件中
#   文件名类似：kiro-auth-token.json 或包含 "refreshToken" 字段的缓存文件
#
# IdC tokens:
#   位于 ~/.aws/sso/cache/ 目录下的JSON文件中
#   需要同时提供 clientId 和 clientSecret
#
# ============================================================================
# 最佳实践
# ============================================================================
#
# 1. 生产环境配置：
#    - 使用 GIN_MODE=release
#    - 配置多个token实现负载均衡
#    - 设置 LOG_LEVEL=info 或 warn
#    - 启用日志文件记录: LOG_FILE=/var/log/kiro2api.log
#
# 2. 开发环境配置：
#    - 使用 GIN_MODE=debug
#    - 设置 LOG_LEVEL=debug
#    - 保持控制台输出: LOG_CONSOLE=true
#
# 3. 故障排除：
#    - 启用 LOG_LEVEL=debug 查看详细日志
#    - 检查token是否过期：查看日志中的"token刷新"相关信息
#    - 验证JSON格式：使用在线JSON验证器检查KIRO_AUTH_TOKEN格式
#    - 检查使用限制：日志会显示剩余可用次数
